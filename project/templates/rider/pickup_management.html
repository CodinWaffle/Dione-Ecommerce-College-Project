<!-- Pickup Management Page -->
{% extends 'rider/_base.html' %} {% block title %}Pickup Management{% endblock
%} {% block content %}
<main class="dashboard-main">
  <section class="dashboard-header">
    <h1>Pickup Management</h1>
    <div class="dashboard-search">
      <input
        type="text"
        id="pickupSearchInput"
        class="search-bar"
        placeholder="Search pickups..."
      />
    </div>
  </section>
  <section class="dashboard-table-section">
    <table class="dashboard-table">
      <thead>
        <tr>
          <th>Pickup #</th>
          <th>Seller Name</th>
          <th>Address</th>
          <th>Contact</th>
          <th>Items</th>
          <th>Notes</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="pickupTableBody">
        {% for pickup in pickups %}
        <tr
          data-pickup-id="{{ pickup.id }}"
          data-raw-status="{{ pickup.raw_status }}"
          data-assigned="{{ '1' if pickup.assigned_to_me else '0' }}"
        >
          <td>{{ pickup.pickup_no }}</td>
          <td>{{ pickup.seller_name }}</td>
          <td>{{ pickup.address }}</td>
          <td>{{ pickup.contact or 'N/A' }}</td>
          <td class="pickup-items-cell">
            {% if pickup.item_names %}
            <div class="pickup-item-name">{{ pickup.item_names[0] }}</div>
            {% if pickup.item_names|length > 1 %}
            <div class="pickup-item-extra">
              +{{ pickup.item_names|length - 1 }} more
            </div>
            {% endif %} {% else %} {% set item_count = pickup['items'] or 0 %}
            {{ item_count }} {{ 'item' if item_count == 1 else 'items' }} {%
            endif %}
          </td>
          <td>{{ pickup.notes }}</td>
          <td>
            <span
              class="status-badge pickup-status-badge status-{{ pickup.status|lower|replace(' ', '-') }}"
              >{{ pickup.status }}</span
            >
          </td>
          <td>
            {% if pickup.raw_status == 'pending' and not pickup.assigned_to_me
            %}
            <button class="action-btn accept-pickup-btn" title="Accept pickup">
              <span class="material-symbols-outlined"
                >assignment_turned_in</span
              >
            </button>
            {% endif %} {% if pickup.raw_status in ['pending', 'assigned'] %}
            <button
              class="action-btn mark-picked-up-btn"
              title="Mark as Picked Up"
              {%
              if
              not
              pickup.assigned_to_me
              %}disabled{%
              endif
              %}
            >
              <span class="material-symbols-outlined">check_circle</span>
            </button>
            {% else %}
            <button class="action-btn view-proof-btn" title="View Proof">
              <span class="material-symbols-outlined">visibility</span>
            </button>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</main>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/rider_scripts/pickup_management.js') }}"></script>
{% endblock %}
