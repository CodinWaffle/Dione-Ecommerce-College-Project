{% extends "base.html" %}
{% block content %}
<div class="row mt-4">
  <div class="col-12">
    <div class="card shadow-sm">
      <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
        <h4 class="mb-0">Customer Reviews</h4>
        <a class="btn btn-sm btn-outline-light" href="{{ url_for('seller.store_insights') }}">View Analytics</a>
      </div>
      <div class="table-responsive">
        <table class="table mb-0">
          <thead>
            <tr>
              <th>Product</th>
              <th>Rating</th>
              <th>Comment</th>
              <th>Media</th>
              <th>Response</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody>
            {% for review in reviews %}
            <tr>
              <td>{{ review.product.name }}</td>
              <td>{{ review.rating }}/5</td>
              <td>
                <strong>{{ review.title }}</strong>
                <p class="mb-1">{{ review.body }}</p>
              </td>
              <td>{{ review.media|length }}</td>
              <td>
                <form method="post" action="{{ url_for('seller.store_review_response', review_id=review.id) }}">
                  <div class="input-group">
                    <input type="text" name="message" class="form-control" value="{{ review.response.message if review.response }}">
                    <div class="input-group-append">
                      <button class="btn btn-primary btn-sm" type="submit">Reply</button>
                    </div>
                  </div>
                </form>
                {% if review.response %}
                  <small class="text-muted">Responded on {{ review.response.created_at.strftime('%Y-%m-%d') }}</small>
                {% endif %}
              </td>
              <td>{{ review.created_at.strftime('%Y-%m-%d') }}</td>
            </tr>
            {% else %}
            <tr>
              <td colspan="6" class="text-center text-muted py-4">No reviews yet.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
